name: CD Pipeline 🚀

on:
  workflow_dispatch:  # 🔥 Se ejecuta manualmente

jobs:
  deploy:
    runs-on: self-hosted

    steps:
      - name: 🚀 Deploy nueva versión
        run: |
          Write-Host "🛑 Deteniendo contenedor viejo si existe..."
          try { docker stop proyectodevopsl1 } catch { Write-Host "No hay contenedor corriendo" }
          try { docker rm proyectodevopsl1 } catch { Write-Host "No hay contenedor viejo" }

          Write-Host "⬇️ Descargando última imagen..."
          docker pull eliudfuentes/proyectodevopsl1:latest

          Write-Host "🚀 Corriendo nueva versión..."
          docker run -d --name proyectodevopsl1 -p 3000:3000 eliudfuentes/proyectodevopsl1:latest

